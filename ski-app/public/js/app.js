"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},googleMap=googleMap||{},google=google;googleMap.mapSetup=function(){var e=document.getElementById("map-canvas"),o={zoom:2,center:new google.maps.LatLng(51.490744,(-.140362)),mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(e,o),this.getResorts()},googleMap.getResorts=function(){$.get("http://localhost:3000/api/resorts").done(this.loopThroughResorts)},googleMap.loopThroughResorts=function(e){$.each(e,function(e,o){googleMap.createMarkerForResort(o)})},googleMap.createMarkerForResort=function(e){var o=new google.maps.LatLng(e.lat,e.lng),t=new google.maps.Marker({position:o,region:e.region,map:this.map});this.addInWindowForResort(e,t)},googleMap.addInWindowForResort=function(e,o){google.maps.event.addListener(o,"click",function(){console.log("clicked","lat"+e.lat,"lng"+e.lng),$.get("http://api.openweathermap.org/data/2.5/weather?lat="+e.lat+"&lon="+e.lng+"&units=metric&APPID=17716dc84c929276085ec7322162e7f3").done(function(t){console.log(t),"undefined"!=typeof googleMap.infoWindow&&googleMap.infoWindow.close(),console.log(_typeof(googleMap.infoWindow)),this.infoWindow=new google.maps.InfoWindow({content:"<p>"+e.name+"</p><p>"+e.region+"</p><p>Temperature is "+t.main.temp+" ℃</p><p>Min temperature is "+t.main.temp_min+" ℃</p><p>Max temperature is "+t.main.temp+" ℃</p><p>Weather is "+t.weather[0].description+"</p><p>Wind Speed is "+t.wind.speed+'</p><img src="http://openweathermap.org/img/w/'+t.weather[0].icon+'.png" alt="icon"><input type="button" id="forecast"/><a href="#" id="flights">Find flights</a>'}),googleMap.addForecast(e),googleMap.findFlights(),this.infoWindow.open(this.map,o),googleMap.map.setCenter(o.getPosition()),googleMap.map.setZoom(5)})})},googleMap.addForecast=function(e){$("#map-canvas").on("click","#forecast",function(){$.get("http://api.openweathermap.org/data/2.5/forecast?lat="+e.lat+"&lon="+e.lng+"&units=metric&APPID=17716dc84c929276085ec7322162e7f3").done(function(e){console.log(e.list[15].dt_txt),$(".modal-content").html('\n              <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                <h4 class="modal-title">Forecast</h4>\n              </div>\n              <div class="modal-body">\n                <p>'+e.list[7].dt_txt+"</p>\n                <p>Average Temperature: "+e.list[7].main.temp+" ℃</p>\n                <p>Min Temperature: "+e.list[7].main.temp_min+" ℃</p>\n                <p>Max Temperature: "+e.list[7].main.temp_max+" ℃</p>\n                <p>Weather Main: "+e.list[7].weather[0].main+"</p>\n                <p>Weather Description: "+e.list[7].weather[0].description+"</p>\n                <p>Wind Speed: "+e.list[7].wind.speed+' meters per second</p>\n                <img src="http://openweathermap.org/img/w/'+e.list[7].weather[0].icon+'.png" alt="icon">\n\n              </div>\n              <div class="modal-footer">\n                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n              </div>'),$(".modal").modal("show")})})},googleMap.findFlights=function(){$("#map-canvas").on("click","#flights",function(e){e&&e.preventDefault();var o={request:{slice:[{origin:"DCA",destination:"LAX",date:"2017-02-11"}],passengers:{adultCount:1,infantInLapCount:0,infantInSeatCount:0,childCount:0,seniorCount:0},solutions:20,refundable:!1}};$.ajax({type:"POST",url:"https://www.googleapis.com/qpxExpress/v1/trips/search?key=AIzaSyBeNMXTnV9y9muXtJCm-5BlC5sG1YRsVA0",contentType:"application/json",dataType:"json",data:JSON.stringify(o),success:function(e){console.log(JSON.stringify(e))},error:function(){alert("Access to Google QPX Failed.")}})})},$(googleMap.mapSetup.bind(googleMap));